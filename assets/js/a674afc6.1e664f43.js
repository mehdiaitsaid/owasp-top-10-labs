"use strict";(self.webpackChunkowasp_top_10_labs=self.webpackChunkowasp_top_10_labs||[]).push([[929],{799:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img-2dc9979e412b3ea5dccb279aa8242100.png"},977:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_3-cbfc23d9d7ba48ff2a0ef8a2d2ee7cd4.png"},978:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/mini-project-demo-760e49b4eea34cfc6cd0fadd253f719f.gif"},1438:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"broken-access-control","title":"Broken Access Control","description":"Introduction","source":"@site/labs/broken-access-control.md","sourceDirName":".","slug":"/broken-access-control","permalink":"/owasp-top-10-labs/labs/broken-access-control","draft":false,"unlisted":false,"editUrl":"https://github.com/mehdiaitsaid/owasp-top-10-labs/blob/master/labs/broken-access-control.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Broken Access Control","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"XSS","permalink":"/owasp-top-10-labs/labs/injection/xss"},"next":{"title":"Cryptographic Failures","permalink":"/owasp-top-10-labs/labs/cryptographic-failures"}}');var t=i(4848),r=i(8453);const l={title:"Broken Access Control",sidebar_position:4},o="Broken Access Control",a={},d=[{value:"Introduction",id:"introduction",level:2},{value:"What is Broken Access Control?",id:"what-is-broken-access-control",level:3},{value:"Root causes",id:"root-causes",level:3},{value:"How attackers exploit it",id:"how-attackers-exploit-it",level:3},{value:"Typical impacts",id:"typical-impacts",level:3},{value:"Real-world scenarios",id:"real-world-scenarios",level:3},{value:"1) Direct object reference exposure",id:"1-direct-object-reference-exposure",level:4},{value:"2) Function-level access missing",id:"2-function-level-access-missing",level:4},{value:"3) Mass-assignment escalation",id:"3-mass-assignment-escalation",level:4},{value:"4) Predictable file paths or identifiers",id:"4-predictable-file-paths-or-identifiers",level:4},{value:"5) Token or session misuse",id:"5-token-or-session-misuse",level:4},{value:"Mitigating Broken Access Control \u2014 ACLs (Roles, Permissions, Policies)",id:"mitigating-broken-access-control--acls-roles-permissions-policies",level:2},{value:"1- Authentication vs Authorization (Before ACLs)",id:"1--authentication-vs-authorization-before-acls",level:3},{value:"2- High-level principles (always follow)",id:"2--high-level-principles-always-follow",level:3},{value:"3 \u2014 ACL concepts explained (roles, permissions, policies)",id:"3--acl-concepts-explained-roles-permissions-policies",level:3},{value:"4 \u2014 Recommended data model (SQL-ish)",id:"4--recommended-data-model-sql-ish",level:3},{value:"5 \u2014 Permission naming conventions",id:"5--permission-naming-conventions",level:3},{value:"6 \u2014 Authorization evaluation flow (recommended)",id:"6--authorization-evaluation-flow-recommended",level:3},{value:"Example enforcement middleware (PHP pseudocode)",id:"example-enforcement-middleware-php-pseudocode",level:4},{value:"Example: creating roles and permissions (SQL seed)",id:"example-creating-roles-and-permissions-sql-seed",level:4},{value:"Lab",id:"lab",level:2},{value:"Introduction",id:"introduction-1",level:3},{value:"Lab Objective",id:"lab-objective",level:3},{value:"Setup",id:"setup",level:3},{value:"Phase 1 \u2014 Implementing the Appointments REST API",id:"phase-1--implementing-the-appointments-rest-api",level:3},{value:"Step 1 \u2014 Setting Up the Endpoint Structure",id:"step-1--setting-up-the-endpoint-structure",level:4},{value:"Step 2 \u2014 Handle HTTP Methods",id:"step-2--handle-http-methods",level:4},{value:"Step 3 \u2014 Fetch Appointments (GET)",id:"step-3--fetch-appointments-get",level:4},{value:"Step 4 \u2014 Create a New Appointment (POST)",id:"step-4--create-a-new-appointment-post",level:4},{value:"Step 5 \u2014 Update an Appointment (PUT)",id:"step-5--update-an-appointment-put",level:4},{value:"Step 6 \u2014 Delete an Appointment (DELETE)",id:"step-6--delete-an-appointment-delete",level:4},{value:"Step 7 \u2014 Test the API",id:"step-7--test-the-api",level:4},{value:"Phase 2 \u2014 Implementing User Authentication and the /me Endpoint",id:"phase-2--implementing-user-authentication-and-the-me-endpoint",level:3},{value:"Step 1 \u2014 Login API",id:"step-1--login-api",level:3},{value:"Step 2 \u2014 /me Endpoint",id:"step-2--me-endpoint",level:4},{value:"Step 3 \u2014 Testing",id:"step-3--testing",level:4},{value:"Phase 3 \u2014 Adding Authentication to Appointments API",id:"phase-3--adding-authentication-to-appointments-api",level:3},{value:"Steps:",id:"steps",level:4},{value:"Testing:",id:"testing",level:4},{value:"Phase 4 \u2014 Role-Based Access Control (Admin Only) for Appointments API",id:"phase-4--role-based-access-control-admin-only-for-appointments-api",level:3},{value:"Steps:",id:"steps-1",level:4},{value:"Testing:",id:"testing-1",level:4},{value:"Phase 5 \u2014 Permission-Based Access Control per Endpoint",id:"phase-5--permission-based-access-control-per-endpoint",level:3},{value:"Objective:",id:"objective",level:4},{value:"Steps:",id:"steps-2",level:4},{value:"Testing:",id:"testing-2",level:4},{value:"Phase 5 \u2014 Policy-Based Access Control (PBAC)",id:"phase-5--policy-based-access-control-pbac",level:3},{value:"Concept Overview",id:"concept-overview",level:4},{value:"Scenario in This Lab",id:"scenario-in-this-lab",level:4},{value:"Steps",id:"steps-3",level:4},{value:"Testing:",id:"testing-3",level:4},{value:"Mini Project \u2014 Simple RBAC Dashboard (Final Instructions)",id:"mini-project--simple-rbac-dashboard-final-instructions",level:2},{value:"Objective :",id:"objective-",level:3},{value:"What you must do (concise)",id:"what-you-must-do-concise",level:3},{value:"Testing (what to include in your submission)",id:"testing-what-to-include-in-your-submission",level:3},{value:"Submission (single PDF only)",id:"submission-single-pdf-only",level:3},{value:"Demo",id:"demo",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"broken-access-control",children:"Broken Access Control"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.h3,{id:"what-is-broken-access-control",children:"What is Broken Access Control?"}),"\n",(0,t.jsx)(n.p,{children:"Broken Access Control occurs when a system fails to correctly enforce who can access or perform which actions on resources. When access control is broken, an actor (authenticated or not) can view, modify, delete, or execute things they are not authorized to."}),"\n",(0,t.jsx)(n.h3,{id:"root-causes",children:"Root causes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Missing server-side checks \u2014 relying only on client-side UI restrictions."}),"\n",(0,t.jsx)(n.li,{children:"Inconsistent enforcement \u2014 some code paths validate permissions while others do not."}),"\n",(0,t.jsx)(n.li,{children:"Predictable or exposed object identifiers (sequential IDs, predictable filenames) enabling simple guessing."}),"\n",(0,t.jsx)(n.li,{children:"Overly broad default permissions or roles that grant more privileges than intended."}),"\n",(0,t.jsx)(n.li,{children:"Complex or fragmented authorization logic that omits edge cases."}),"\n",(0,t.jsx)(n.li,{children:"Automatic binding / mass assignment where incoming data is mapped directly to internal fields."}),"\n",(0,t.jsx)(n.li,{children:"Session/token scoping mistakes \u2014 tokens that aren\u2019t limited in scope or lifetime."}),"\n",(0,t.jsx)(n.li,{children:"Hidden or debug functionality left enabled in production code."}),"\n",(0,t.jsx)(n.li,{children:"Trusting client-supplied data for authorization decisions."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-attackers-exploit-it",children:"How attackers exploit it"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Parameter tampering \u2014 changing an identifier in a request (e.g., document_id=45 \u2192 document_id=46) to access another user\u2019s resource."}),"\n",(0,t.jsx)(n.li,{children:"Direct object reference guessing (IDOR) \u2014 sequential or predictable IDs allow enumeration of resources."}),"\n",(0,t.jsx)(n.li,{children:"Mass assignment \u2014 sending extra fields (e.g., is_admin=true) that the server accepts and persists."}),"\n",(0,t.jsx)(n.li,{children:"Function-level access bypass \u2014 invoking privileged actions directly when only the UI prevented access."}),"\n",(0,t.jsx)(n.li,{children:"Token replay / token reuse \u2014 using another user\u2019s session token where tokens are not scoped or revoked."}),"\n",(0,t.jsx)(n.li,{children:"Chaining operations \u2014 combining multiple allowed actions in a sequence to escalate privileges."}),"\n",(0,t.jsx)(n.li,{children:"Hidden endpoint discovery \u2014 calling endpoints or functions that exist but are not properly guarded."}),"\n",(0,t.jsx)(n.li,{children:"Client-side control manipulation \u2014 altering forms or scripts so that the client sends values that the server then trusts."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"typical-impacts",children:"Typical impacts"}),"\n",(0,t.jsx)(n.p,{children:"Unauthorized data disclosure (personal records, invoices, documents).\nUnauthorized data modification (changing records, prices, or settings).\nPrivilege escalation (ordinary users gaining administrative capabilities).\nResource deletion or denial-of-service for legitimate users.\nLegal, regulatory, and reputational consequences."}),"\n",(0,t.jsx)(n.h3,{id:"real-world-scenarios",children:"Real-world scenarios"}),"\n",(0,t.jsx)(n.h4,{id:"1-direct-object-reference-exposure",children:"1) Direct object reference exposure"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Setup: Resources are accessed by a simple identifier (e.g., /resource?id=123). The system returns the resource if the identifier exists but does not verify ownership."}),"\n",(0,t.jsx)(n.li,{children:"Exploit: An actor increments the identifier to 124 and receives another person\u2019s document."}),"\n",(0,t.jsx)(n.li,{children:"Result: Confidential data is disclosed."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"2-function-level-access-missing",children:"2) Function-level access missing"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Setup: A privileged action (delete, approve, override) is available in the user interface only for certain roles, but the underlying function does not check roles."}),"\n",(0,t.jsx)(n.li,{children:"Exploit: Any authenticated user invokes the function directly and performs the privileged action."}),"\n",(0,t.jsx)(n.li,{children:"Result: Unauthorized modifications or deletions."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"3-mass-assignment-escalation",children:"3) Mass-assignment escalation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Setup: Incoming data is bound automatically to a model. Critical fields (e.g., role, status, price) are not protected."}),"\n",(0,t.jsx)(n.li,{children:"Exploit: An actor includes role=admin or price=0 in their submission and the system saves it."}),"\n",(0,t.jsx)(n.li,{children:"Result: Privilege escalation or financial tampering."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"4-predictable-file-paths-or-identifiers",children:"4) Predictable file paths or identifiers"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Setup: Files or documents are stored using predictable names like documents/user_1_report.pdf. Access checks are absent when fetching the file."}),"\n",(0,t.jsx)(n.li,{children:"Exploit: Changing the path to documents/user_2_report.pdf downloads someone else\u2019s file."}),"\n",(0,t.jsx)(n.li,{children:"Result: Exposure of sensitive files."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"5-token-or-session-misuse",children:"5) Token or session misuse"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Setup: Session tokens are long-lived and not scoped; there\u2019s no revocation mechanism."}),"\n",(0,t.jsx)(n.li,{children:"Exploit: A leaked or intercepted token is used to perform actions under another user\u2019s identity."}),"\n",(0,t.jsx)(n.li,{children:"Result: Account takeover and unauthorized actions."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"mitigating-broken-access-control--acls-roles-permissions-policies",children:"Mitigating Broken Access Control \u2014 ACLs (Roles, Permissions, Policies)"}),"\n",(0,t.jsx)(n.p,{children:"This section shows how to mitigate Broken Access Control by implementing a robust Access Control List (ACL) system. It explains the three levels (roles, permissions, policies), data model, enforcement points, examples, and practical advice for secure, testable access control."}),"\n",(0,t.jsx)(n.h3,{id:"1--authentication-vs-authorization-before-acls",children:"1- Authentication vs Authorization (Before ACLs)"}),"\n",(0,t.jsx)(n.p,{children:"Before implementing Access Control Lists (ACLs), it\u2019s essential to understand the difference between authentication and authorization:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Authentication verifies who the user is \u2014 usually by checking credentials like email and password."}),"\n",(0,t.jsx)(n.li,{children:"Authorization defines what the authenticated user is allowed to do \u2014 for example, whether a doctor can view a patient\u2019s file or update medical notes."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In secure systems, authentication always happens first, followed by authorization checks enforced through roles, permissions, and policies. Together, these form the foundation for preventing Broken Access Control vulnerabilities."}),"\n",(0,t.jsx)(n.h3,{id:"2--high-level-principles-always-follow",children:"2- High-level principles (always follow)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Deny by default. If you can\u2019t prove a user has permission, deny the action."}),"\n",(0,t.jsx)(n.li,{children:"Server-side enforcement only. Never rely on client-side checks. All checks must run on the server (or service) that controls the resource."}),"\n",(0,t.jsx)(n.li,{children:"Least privilege. Give users the minimal set of permissions required."}),"\n",(0,t.jsx)(n.li,{children:"Centralize authorization logic. One consistent place to evaluate permissions reduces bugs."}),"\n",(0,t.jsx)(n.li,{children:"Separation of duties. Distinguish authentication (who you are) from authorization (what you can do)."}),"\n",(0,t.jsx)(n.li,{children:"Fail-safe / explicit errors. On error, return a safe response (e.g., 403)."}),"\n",(0,t.jsx)(n.li,{children:"Audit / logging. Record access decisions (allow/deny) for analysis and incident response."}),"\n",(0,t.jsx)(n.li,{children:"Test & review. Automated tests, fuzzing, and manual review for edge cases."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"3--acl-concepts-explained-roles-permissions-policies",children:"3 \u2014 ACL concepts explained (roles, permissions, policies)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Roles"})," \u2014 named groupings representing job functions or user categories (e.g., admin, editor, viewer). Roles simplify management by bundling permissions.\n",(0,t.jsx)(n.strong,{children:"Permissions"})," \u2014 fine-grained actions the system understands, usually expressed as resource",":action"," (e.g., document",":read",", appointment",":cancel",", billing",":update",").\n",(0,t.jsx)(n.strong,{children:"Policies"})," \u2014 rules that evaluate context and attributes beyond static role-permission mappings. Policies can include ownership, time windows, attributes, or resource-specific rules (e.g., \u201cusers can edit resources they own\u201d, \u201cclinicians can view tests for their assigned patients\u201d, \u201conly during working hours\u201d)."]}),"\n",(0,t.jsx)(n.p,{children:"Together they let you express:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Role-based grants (RBAC): role -> permission"}),"\n",(0,t.jsx)(n.li,{children:"Attribute-based constraints (ABAC / policies): permission allowed only if context conditions hold"}),"\n",(0,t.jsx)(n.li,{children:"Per-resource overrides: ACL entries for specific objects (e.g., acl_entries(resource_type, resource_id, subject, permission))"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"4--recommended-data-model-sql-ish",children:"4 \u2014 Recommended data model (SQL-ish)"}),"\n",(0,t.jsx)(n.p,{children:"A minimal but practical schema that supports roles, permissions, role assignments, direct permission grants, and resource-level ACLs:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'-- Roles and permissions\nCREATE TABLE roles (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(100) UNIQUE NOT NULL,\n  description VARCHAR(255)\n);\n\nCREATE TABLE permissions (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(150) UNIQUE NOT NULL  -- e.g., "appointments:create", "patients:view"\n);\n\nCREATE TABLE role_permissions (\n  role_id INT NOT NULL,\n  permission_id INT NOT NULL,\n  PRIMARY KEY (role_id, permission_id),\n  FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE,\n  FOREIGN KEY (permission_id) REFERENCES permissions(id) ON DELETE CASCADE\n);\n\n-- User-role assignments\nCREATE TABLE user_roles (\n  user_id BIGINT NOT NULL,\n  role_id INT NOT NULL,\n  PRIMARY KEY (user_id, role_id),\n  FOREIGN KEY (role_id) REFERENCES roles(id)\n);\n\n-- Optional: direct user permissions (overrides/exception)\nCREATE TABLE user_permissions (\n  user_id BIGINT NOT NULL,\n  permission_id INT NOT NULL,\n  allowed TINYINT(1) NOT NULL DEFAULT 1, -- 1 = allow, 0 = deny\n  PRIMARY KEY (user_id, permission_id),\n  FOREIGN KEY (permission_id) REFERENCES permissions(id)\n);\n\n-- Resource-level ACL (object-level)\nCREATE TABLE resource_acl (\n  id BIGINT AUTO_INCREMENT PRIMARY KEY,\n  resource_type VARCHAR(100) NOT NULL,   -- e.g., "appointment", "file"\n  resource_id VARCHAR(255) NOT NULL,     -- object identifier\n  subject_type ENUM(\'user\',\'role\') NOT NULL,\n  subject_id VARCHAR(255) NOT NULL,      -- user_id or role_id\n  permission_id INT NOT NULL,\n  allowed TINYINT(1) DEFAULT 1,\n  FOREIGN KEY (permission_id) REFERENCES permissions(id)\n);\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,t.jsx)(n.p,{children:"resource_id is a string so it handles UUIDs or composite keys.\nUsing both user_permissions and resource_acl allows exceptions and per-resource overrides.\nThe permissions table centralizes naming so code can check by name or ID."}),"\n",(0,t.jsx)(n.h3,{id:"5--permission-naming-conventions",children:"5 \u2014 Permission naming conventions"}),"\n",(0,t.jsx)(n.p,{children:"Use hierarchical, descriptive permission names:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["resource",":action"," [",":scope","]"]}),"\n",(0,t.jsxs)(n.li,{children:["Examples: appointments",":create",", appointments",":read",", appointments",":update",", files",":download",", billing",":adjust",".\nThis helps map permissions to UI actions and audit logs."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"6--authorization-evaluation-flow-recommended",children:"6 \u2014 Authorization evaluation flow (recommended)"}),"\n",(0,t.jsx)(n.p,{children:"Design a single function (middleware/service) that answers a single question: \u201cIs subject S allowed to perform ACTION A on RESOURCE R given CONTEXT C?\u201d\nExample algorithm:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Authenticate user \u2192 obtain user_id, roles[], session."}),"\n",(0,t.jsxs)(n.li,{children:["Fetch static grants:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Union permissions from roles -> role_permissions."}),"\n",(0,t.jsx)(n.li,{children:"Add any user_permissions direct grants (explicit deny should override allow)."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Check explicit resource-level ACLs in resource_acl for the specific resource_type + resource_id. If an explicit deny exists, return deny. If an explicit allow exists, tentatively allow but still run policies."}),"\n",(0,t.jsxs)(n.li,{children:["Check policy rules (ABAC):","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Example checks: owner == user_id, user.department == resource.department, time_of_day allowed, appointment.clinician_id == user_id."}),"\n",(0,t.jsx)(n.li,{children:"Policies can be code functions or declarative rules stored in DB (careful with complexity)."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Combine results:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Explicit deny anywhere \u2192 deny."}),"\n",(0,t.jsx)(n.li,{children:"Explicit allow from ACL or role + policy satisfied \u2192 allow."}),"\n",(0,t.jsx)(n.li,{children:"Nothing matched \u2192 deny (deny-by-default)."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Return true/false, and record decision (optionally)."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-enforcement-middleware-php-pseudocode",children:"Example enforcement middleware (PHP pseudocode)"}),"\n",(0,t.jsx)(n.p,{children:"Place this logic in a single, reusable function and call it at every protected endpoint or service boundary."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"function authorize($pdo, $userId, $permissionName, $resourceType = null, $resourceId = null, $context = []) {\n    // 1) Load permission id\n    $perm = $pdo->prepare(\"SELECT id FROM permissions WHERE name = ?\");\n    $perm->execute([$permissionName]);\n    $permRow = $perm->fetch();\n    if (!$permRow) return false; // unknown permission -> deny\n\n    $permId = $permRow['id'];\n\n    // 2) Check explicit resource ACL (highest priority for object-level control)\n    if ($resourceType && $resourceId) {\n        $acl = $pdo->prepare(\"SELECT allowed, subject_type, subject_id FROM resource_acl WHERE resource_type=? AND resource_id=? AND permission_id=? LIMIT 1\");\n        $acl->execute([$resourceType, $resourceId, $permId]);\n        $aclRow = $acl->fetch();\n        if ($aclRow) {\n            // if subject applies to user or user's role (resolve role check outside)\n            if ($aclRow['subject_type'] === 'user' && intval($aclRow['subject_id']) === intval($userId)) {\n                return (bool)$aclRow['allowed'];\n            }\n            // role subject handling could be added here (check user's roles)\n        }\n    }\n\n    // 3) User-specific permission overrides\n    $up = $pdo->prepare(\"SELECT allowed FROM user_permissions WHERE user_id=? AND permission_id=?\");\n    $up->execute([$userId, $permId]);\n    if ($upRow = $up->fetch()) {\n        return (bool)$upRow['allowed'];\n    }\n\n    // 4) Role-based permissions\n    $r = $pdo->prepare(\"\n        SELECT 1 FROM role_permissions rp\n        JOIN user_roles ur ON ur.role_id = rp.role_id\n        WHERE ur.user_id = ? AND rp.permission_id = ? LIMIT 1\n    \");\n    $r->execute([$userId, $permId]);\n    if (!$r->fetch()) {\n        // user has no role grant -> deny by default\n        return false;\n    }\n\n    // 5) Policy checks (example: ownership)\n    // This is application-specific. Example: if permissionName ends with ':edit' and resource has owner_id\n    if ($resourceType && $resourceId) {\n        // example policy: allow if owner\n        $ownerStmt = $pdo->prepare(\"SELECT owner_id FROM \" . $resourceType . \" WHERE id = ? LIMIT 1\");\n        $ownerStmt->execute([$resourceId]);\n        if ($row = $ownerStmt->fetch()) {\n            if ($row['owner_id'] == $userId) return true;\n        }\n    }\n\n    // 6) No explicit deny and role has permission -> allow\n    return true;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"This is simplified; real implementation should handle role subjects in resource_acl, policy engine, caching, and performance."}),"\n",(0,t.jsx)(n.li,{children:"Policies often require fetching resource metadata (e.g., owner_id) \u2014 do it efficiently or cache."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-creating-roles-and-permissions-sql-seed",children:"Example: creating roles and permissions (SQL seed)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- permissions\nINSERT INTO permissions (name) VALUES\n  ('appointments:create'),\n  ('appointments:read'),\n  ('appointments:update'),\n  ('appointments:delete'),\n  ('files:download');\n\n-- roles\nINSERT INTO roles (name) VALUES ('admin'), ('clinician'), ('receptionist');\n\n-- grant clinician read/update appointments\nINSERT INTO role_permissions (role_id, permission_id)\nSELECT r.id, p.id FROM roles r, permissions p\nWHERE r.name='clinician' AND p.name IN ('appointments:read','appointments:update');\n\n-- admin gets everything (example)\nINSERT INTO role_permissions (role_id, permission_id)\nSELECT r.id, p.id FROM roles r, permissions p WHERE r.name='admin';\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lab",children:"Lab"}),"\n",(0,t.jsx)(n.h3,{id:"introduction-1",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"In this lab, we will implement a secure RESTful API for a hospital management system. The goal is to design and develop backend services that handle sensitive healthcare operations\u2014such as user authentication, appointment scheduling, and patient\u2013clinician interactions\u2014while applying best security practices to protect data integrity, confidentiality, and access control."}),"\n",(0,t.jsx)(n.p,{children:"A REST API (Representational State Transfer Application Programming Interface) is an architectural style that allows different systems to communicate over the web using standard HTTP methods. REST APIs are widely used because they are stateless, scalable, and easy to integrate with both web and mobile applications."}),"\n",(0,t.jsx)(n.p,{children:"The table below summarizes the most common HTTP methods (verbs) used in REST APIs and their purposes:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"HTTP Method"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Description"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Typical Use Case"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"GET"})}),(0,t.jsx)(n.td,{children:"Retrieve data from the server."}),(0,t.jsx)(n.td,{children:"Get a list of appointments or details of a specific patient."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"POST"})}),(0,t.jsx)(n.td,{children:"Send new data to the server."}),(0,t.jsx)(n.td,{children:"Create a new user or schedule a new appointment."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"PUT"})}),(0,t.jsx)(n.td,{children:"Update existing data on the server."}),(0,t.jsx)(n.td,{children:"Modify a patient\u2019s information or update appointment details."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"DELETE"})}),(0,t.jsx)(n.td,{children:"Remove data from the server."}),(0,t.jsx)(n.td,{children:"Delete an appointment or remove a user record."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"PATCH"})}),(0,t.jsx)(n.td,{children:"Partially update existing data."}),(0,t.jsx)(n.td,{children:"Change only the appointment status (e.g., from \u201cPending\u201d to \u201cConfirmed\u201d)."})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"In the following sections, we will begin implementing these operations step by step to build a complete and secure REST API for the hospital system."}),"\n",(0,t.jsx)(n.h3,{id:"lab-objective",children:"Lab Objective"}),"\n",(0,t.jsx)(n.p,{children:"The objective of this lab is to identify and fix Broken Access Control vulnerabilities in a hospital REST API.\nYou will learn how to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Implement role-based restrictions to prevent unauthorized actions."}),"\n",(0,t.jsx)(n.li,{children:"Secure endpoints so that only allowed users can access or modify specific data."}),"\n",(0,t.jsx)(n.li,{children:"Apply least privilege principles for all API operations."}),"\n",(0,t.jsx)(n.li,{children:"Test and verify access control rules to ensure data isolation between users."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,t.jsxs)(n.p,{children:["In this lab, we will continue using the same hospital database created in the ",(0,t.jsx)(n.a,{href:"/owasp-top-10-labs/labs/setup",children:"setup section"}),".\nAll authentication, authorization, and access control mechanisms will be built on top of this existing data model, which already includes users, roles, patients, appointments, and related entities."]}),"\n",(0,t.jsx)(n.p,{children:"We will start by implementing user authentication through a secure login API, then progressively add authorization rules to protect sensitive endpoints such as patient records, medical notes, and billing information."}),"\n",(0,t.jsx)(n.h3,{id:"phase-1--implementing-the-appointments-rest-api",children:"Phase 1 \u2014 Implementing the Appointments REST API"}),"\n",(0,t.jsx)(n.h4,{id:"step-1--setting-up-the-endpoint-structure",children:"Step 1 \u2014 Setting Up the Endpoint Structure"}),"\n",(0,t.jsx)(n.p,{children:"Create a new file called appointments.php inside your API folder.\nThis file will handle all CRUD (Create, Read, Update, Delete) operations related to appointments.\nWe\u2019ll use the same db.php and utils.php files for database connection and JSON responses."}),"\n",(0,t.jsx)(n.h4,{id:"step-2--handle-http-methods",children:"Step 2 \u2014 Handle HTTP Methods"}),"\n",(0,t.jsx)(n.p,{children:"Inside appointments.php, start by detecting the HTTP request method using $_SERVER['REQUEST_METHOD'].\nDepending on the method, call the appropriate function:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"GET \u2192 Retrieve appointments"}),"\n",(0,t.jsx)(n.li,{children:"POST \u2192 Create a new appointment"}),"\n",(0,t.jsx)(n.li,{children:"PUT \u2192 Update an existing appointment"}),"\n",(0,t.jsx)(n.li,{children:"DELETE \u2192 Remove an appointment"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Note: You can test the API using any HTTP client (e.g., curl, Insomnia, or browser plugins).\nIn this lab, we will use Postman to send requests and verify the behavior of each endpoint."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"step-3--fetch-appointments-get",children:"Step 3 \u2014 Fetch Appointments (GET)"}),"\n",(0,t.jsx)(n.p,{children:"Write a SQL query to retrieve appointments along with their related patient and clinician details.\nUse a JOIN between the appointments, patients, and users tables.\nReturn the result as JSON using your helper function."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example idea:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"/api/appointments \u2192 returns all appointments"}),"\n",(0,t.jsx)(n.li,{children:"/api/appointments?id=3 \u2192 returns details for appointment with ID 3"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Code sample:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'        if (isset($_GET[\'id\'])) {\n            $stmt = $pdo->prepare("SELECT * FROM appointments WHERE id = ?");\n            $stmt->execute([$_GET[\'id\']]);\n            $appointment = $stmt->fetch(PDO::FETCH_ASSOC);\n            if (!$appointment) sendJson(["error" => "Appointment not found"], 404);\n            sendJson($appointment);\n        } else {\n            $stmt = $pdo->query("SELECT * FROM appointments");\n            sendJson($stmt->fetchAll(PDO::FETCH_ASSOC));\n        }\n'})}),"\n",(0,t.jsx)(n.p,{children:"Result for All :"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_1.png",src:i(7203).A+"",width:"1986",height:"1501"})}),"\n",(0,t.jsx)(n.p,{children:"Result for One :"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_2.png",src:i(2712).A+"",width:"1986",height:"1288"})}),"\n",(0,t.jsx)(n.h4,{id:"step-4--create-a-new-appointment-post",children:"Step 4 \u2014 Create a New Appointment (POST)"}),"\n",(0,t.jsx)(n.p,{children:"Read JSON input from php://input containing the appointment details such as:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"patient_id"}),"\n",(0,t.jsx)(n.li,{children:"clinician_id"}),"\n",(0,t.jsx)(n.li,{children:"scheduled_at"}),"\n",(0,t.jsx)(n.li,{children:"reason"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Then insert a new row into the appointments table.\nReturn a success message and the new appointment ID in JSON."}),"\n",(0,t.jsx)(n.p,{children:"Code sample:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"        $input = json_decode(file_get_contents('php://input'), true);\n        if (!$input || !isset($input['patient_id'], $input['clinician_id'], $input['date_time'], $input['reason'])) {\n            sendJson([\"error\" => \"Missing required fields\"], 400);\n        }\n\n        $stmt = $pdo->prepare(\"\n            INSERT INTO appointments (patient_id, clinician_id, date_time, reason, status)\n            VALUES (?, ?, ?, ?, ?)\n        \");\n        $stmt->execute([\n            $input['patient_id'],\n            $input['clinician_id'],\n            $input['date_time'],\n            $input['reason'],\n            $input['status'] ?? 'Scheduled'\n        ]);\n\n        sendJson([\"message\" => \"Appointment created successfully\", \"id\" => $pdo->lastInsertId()], 201);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Result :\n",(0,t.jsx)(n.img,{alt:"img_3.png",src:i(977).A+"",width:"1984",height:"1095"})]}),"\n",(0,t.jsx)(n.h4,{id:"step-5--update-an-appointment-put",children:"Step 5 \u2014 Update an Appointment (PUT)"}),"\n",(0,t.jsx)(n.p,{children:"Read the appointment id and updated fields (like status or reason) from the JSON request.\nExecute an UPDATE query to modify the existing record.\nRespond with confirmation that the appointment was updated."}),"\n",(0,t.jsx)(n.p,{children:"Code sample:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"        if (!isset($_GET['id'])) \n            sendJson([\"error\" => \"Missing appointment ID\"], 400);\n        $id = $_GET['id'];\n        $input = json_decode(file_get_contents('php://input'), true);\n\n        $stmt = $pdo->prepare(\"\n            UPDATE appointments\n            SET patient_id = ?, clinician_id = ?, date_time = ?, reason = ?, status = ?\n            WHERE id = ?\n        \");\n        $stmt->execute([\n            $input['patient_id'],\n            $input['clinician_id'],\n            $input['date_time'],\n            $input['reason'],\n            $input['status'],\n            $id\n        ]);\n\n        sendJson([\"message\" => \"Appointment updated successfully\"]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Result :\n",(0,t.jsx)(n.img,{alt:"img_4.png",src:i(4862).A+"",width:"1986",height:"1047"})]}),"\n",(0,t.jsx)(n.h4,{id:"step-6--delete-an-appointment-delete",children:"Step 6 \u2014 Delete an Appointment (DELETE)"}),"\n",(0,t.jsx)(n.p,{children:"Read the id parameter (e.g., /api/appointments?id=5)\nExecute a DELETE query to remove that appointment.\nReturn a JSON message confirming deletion."}),"\n",(0,t.jsx)(n.p,{children:"Code sample:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'if (!isset($_GET[\'id\'])) sendJson(["error" => "Missing appointment ID"], 400);\n        $stmt = $pdo->prepare("DELETE FROM appointments WHERE id = ?");\n        $stmt->execute([$_GET[\'id\']]);\n        sendJson(["message" => "Appointment deleted successfully"]);\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Result:\n",(0,t.jsx)(n.img,{alt:"img.png",src:i(799).A+"",width:"1986",height:"1048"})]}),"\n",(0,t.jsx)(n.h4,{id:"step-7--test-the-api",children:"Step 7 \u2014 Test the API"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman or curl to test each operation:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"GET /api/appointments"}),"\n",(0,t.jsx)(n.li,{children:"POST /api/appointments"}),"\n",(0,t.jsx)(n.li,{children:"PUT /api/appointments"}),"\n",(0,t.jsx)(n.li,{children:"DELETE /api/appointments"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Make sure all CRUD operations work correctly before moving on to adding security controls in the next step."}),"\n",(0,t.jsx)(n.h3,{id:"phase-2--implementing-user-authentication-and-the-me-endpoint",children:"Phase 2 \u2014 Implementing User Authentication and the /me Endpoint"}),"\n",(0,t.jsx)(n.p,{children:"In this phase, we will implement a login API that allows users to authenticate using their email and password and receive an access token. We will also create a /me endpoint that returns information about the currently authenticated user."}),"\n",(0,t.jsx)(n.p,{children:"This step lays the foundation for secure access control in the REST API by verifying users before allowing any sensitive operations."}),"\n",(0,t.jsx)(n.h3,{id:"step-1--login-api",children:"Step 1 \u2014 Login API"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a file called login.php."}),"\n",(0,t.jsxs)(n.li,{children:["Accept POST requests with Basic Authentication headers (email",":password",")."]}),"\n",(0,t.jsx)(n.li,{children:"Validate the user\u2019s credentials against the users table using password_verify()."}),"\n",(0,t.jsx)(n.li,{children:"If credentials are correct, generate a session token and store it in the sessions table with:"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"user_id"}),"\n",(0,t.jsx)(n.li,{children:"session_token"}),"\n",(0,t.jsx)(n.li,{children:"ip_address"}),"\n",(0,t.jsx)(n.li,{children:"user_agent"}),"\n",(0,t.jsx)(n.li,{children:"expires_at (e.g., 1 day from creation)"}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"5",children:["\n",(0,t.jsx)(n.li,{children:"Return a JSON response containing:"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"token \u2014 the access token"}),"\n",(0,t.jsx)(n.li,{children:"user \u2014 basic user information (id, name, email, role_id)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_5.png",src:i(7879).A+"",width:"1983",height:"1320"})}),"\n",(0,t.jsx)(n.h4,{id:"step-2--me-endpoint",children:"Step 2 \u2014 /me Endpoint"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a file called me.php."}),"\n",(0,t.jsx)(n.li,{children:"Accept GET requests."}),"\n",(0,t.jsx)(n.li,{children:"Read the access token from the Authorization: Bearer <token> header."}),"\n",(0,t.jsx)(n.li,{children:"Verify the token exists in the sessions table and has not expired or been revoked."}),"\n",(0,t.jsx)(n.li,{children:"Return the authenticated user\u2019s information in JSON:"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"id"}),"\n",(0,t.jsx)(n.li,{children:"name"}),"\n",(0,t.jsx)(n.li,{children:"email"}),"\n",(0,t.jsx)(n.li,{children:"role_id"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"step-3--testing",children:"Step 3 \u2014 Testing"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman to:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Send a POST request to /login.php with email/password."}),"\n",(0,t.jsx)(n.li,{children:"Receive the access token in the response."}),"\n",(0,t.jsx)(n.li,{children:"Use the token in the Authorization header for /me:"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Authorization: Bearer <token>"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_6.png",src:i(3596).A+"",width:"1989",height:"636"})}),"\n",(0,t.jsxs)(n.ol,{start:"5",children:["\n",(0,t.jsx)(n.li,{children:"Verify the response returns the correct user information."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_7.png",src:i(6661).A+"",width:"1981",height:"1152"})}),"\n",(0,t.jsx)(n.h3,{id:"phase-3--adding-authentication-to-appointments-api",children:"Phase 3 \u2014 Adding Authentication to Appointments API"}),"\n",(0,t.jsx)(n.p,{children:"In this phase, you will update the appointments REST API so that only logged-in users can access it. This ensures that all endpoints are protected by authentication, laying the foundation for secure access control."}),"\n",(0,t.jsx)(n.h4,{id:"steps",children:"Steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Require authentication for all endpoints"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"At the top of appointments.php, read the token from the Authorization header:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Authorization: Bearer <token>"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Verify the token in the sessions table:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Must exist"}),"\n",(0,t.jsx)(n.li,{children:"Must not be expired"}),"\n",(0,t.jsx)(n.li,{children:"Must not be revoked"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"Block unauthenticated requests"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"If the token is missing or invalid, return a 401 Unauthorized response in JSON."}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Use authenticated user info"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Store the authenticated user details in a variable (e.g., $currentUser) to use later in your endpoints if needed."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"testing",children:"Testing:"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log in via /login.php to get a token."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Send requests to /appointments.php with the header:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Authorization: Bearer <token>"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Requests without a token should fail with 401 Unauthorized."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Requests with a valid token should succeed."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-4--role-based-access-control-admin-only-for-appointments-api",children:"Phase 4 \u2014 Role-Based Access Control (Admin Only) for Appointments API"}),"\n",(0,t.jsx)(n.p,{children:"In this phase, you will enforce role-based access control (RBAC) on the appointments REST API. Only users with the admin role will be allowed to access certain endpoints (e.g., create, update, delete appointments), while other logged-in users can only view data if allowed."}),"\n",(0,t.jsx)(n.p,{children:"This demonstrates how to combine authentication (Phase 3) with authorization to implement secure, controlled access."}),"\n",(0,t.jsx)(n.h4,{id:"steps-1",children:"Steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Determine the user\u2019s role"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"After authenticating the user using the Bearer token, fetch the user\u2019s role_id and optionally the role name from the roles table."}),"\n",(0,t.jsx)(n.li,{children:"Store this info in a variable, e.g., $currentUserRole."}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"Restrict access based on role"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"For endpoints like POST, PUT, DELETE in appointments.php, check if the user has the admin role:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"if ($currentUserRole !== 'admin') {\n    sendJson(['error' => 'Forbidden: Admins only'], 403);\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Only allow users with the admin role to perform changes."}),"\n",(0,t.jsx)(n.li,{children:"GET requests may still be allowed for all authenticated users, depending on your design."}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Return proper HTTP codes"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"403 Forbidden \u2192 user is authenticated but does not have the required role."}),"\n",(0,t.jsx)(n.li,{children:"401 Unauthorized \u2192 user is not logged in (handled in Phase 3)."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"testing-1",children:"Testing:"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Log in as an admin user \u2192 get a token."}),"\n",(0,t.jsx)(n.li,{children:"Log in as a non-admin user \u2192 get a token."}),"\n",(0,t.jsx)(n.li,{children:"Test the endpoints:"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Admin token \u2192 should succeed for create/update/delete."}),"\n",(0,t.jsx)(n.li,{children:"Non-admin token \u2192 should return 403 Forbidden."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Note:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"This phase focuses on authorization by role."}),"\n",(0,t.jsx)(n.li,{children:"Combined with Phase 3 authentication, this ensures that only valid, properly authorized users can modify critical resources."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-5--permission-based-access-control-per-endpoint",children:"Phase 5 \u2014 Permission-Based Access Control per Endpoint"}),"\n",(0,t.jsx)(n.p,{children:"What if we want to allow a user to view all appointments but not to create, update, or delete them?\nRole-based access alone (like \u201cadmin\u201d vs. \u201cuser\u201d) may not be enough \u2014 we might need fine-grained permissions that control access per endpoint or action."}),"\n",(0,t.jsx)(n.p,{children:"This phase introduces Permission-Based Access Control (PBAC) \u2014 where each API endpoint is associated with a specific permission."}),"\n",(0,t.jsx)(n.h4,{id:"objective",children:"Objective:"}),"\n",(0,t.jsx)(n.p,{children:"Enhance the access control system to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Define explicit permissions (e.g., view_appointments, create_appointments, update_appointments, delete_appointments)."}),"\n",(0,t.jsx)(n.li,{children:"Assign permissions to roles (e.g., admin, doctor, user)."}),"\n",(0,t.jsx)(n.li,{children:"Enforce these permissions at the API level for every request."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"steps-2",children:"Steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Determine the user\u2019s role"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"After authenticating the user using the Bearer token, fetch the user\u2019s role_id and optionally the role name from the roles table."}),"\n",(0,t.jsx)(n.li,{children:"Store this info in a variable, e.g., $currentUserRole."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Restrict access based on role"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"For endpoints like POST, PUT, DELETE in appointments.php, check if the user has the admin role:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"if ($currentUserRole !== 'admin') {\n    sendJson(['error' => 'Forbidden: Admins only'], 403);\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Only allow users with the admin role to perform changes."}),"\n",(0,t.jsx)(n.li,{children:"GET requests may still be allowed for all authenticated users, depending on your design."}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Return proper HTTP codes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"403 Forbidden \u2192 user is authenticated but does not have the required role."}),"\n",(0,t.jsx)(n.li,{children:"401 Unauthorized \u2192 user is not logged in (handled in Phase 3)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"testing-2",children:"Testing:"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log in as an admin user \u2192 get a token."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log in as a non-admin user \u2192 get a token."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Test the endpoints:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Admin token \u2192 should succeed for create/update/delete."}),"\n",(0,t.jsx)(n.li,{children:"Non-admin token \u2192 should return 403 Forbidden."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-5--policy-based-access-control-pbac",children:"Phase 5 \u2014 Policy-Based Access Control (PBAC)"}),"\n",(0,t.jsx)(n.p,{children:"In this phase, you will implement policy-based access control to refine authorization beyond simple roles.\nWhile roles define who you are (e.g., admin, clinician), policies define what you can do under certain conditions."}),"\n",(0,t.jsx)(n.p,{children:"This ensures fine-grained control, such as allowing clinicians to access only their own appointments, while admins can access all appointments."}),"\n",(0,t.jsx)(n.h4,{id:"concept-overview",children:"Concept Overview"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Access Type"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Description"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Role/Permission-Based"})}),(0,t.jsx)(n.td,{children:"Access based on role or permission(e.g., only admins can manage data)."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Policy-Based"})}),(0,t.jsx)(n.td,{children:"Access depends on specific conditions (e.g., clinicians can only modify their own records)."})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"scenario-in-this-lab",children:"Scenario in This Lab"}),"\n",(0,t.jsx)(n.p,{children:"You will implement two policy rules for the appointments API:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Action"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Policy Rule"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"GET /appointments"})}),(0,t.jsxs)(n.td,{children:["- ",(0,t.jsx)(n.strong,{children:"Admins:"})," Can retrieve all appointments. - ",(0,t.jsx)(n.strong,{children:"Clinicians:"})," Can retrieve only their own appointments (`WHERE clinician_id = user_id`)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"PUT /appointments/{id}"})}),(0,t.jsxs)(n.td,{children:["- ",(0,t.jsx)(n.strong,{children:"Admins:"})," Can update any appointment. - ",(0,t.jsx)(n.strong,{children:"Clinicians:"})," Can update only appointments assigned to them."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"DELETE /appointments/{id}"})}),(0,t.jsxs)(n.td,{children:["- ",(0,t.jsx)(n.strong,{children:"Admins only."})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"POST /appointments"})}),(0,t.jsxs)(n.td,{children:["- ",(0,t.jsx)(n.strong,{children:"Admins only (optional)."})]})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"steps-3",children:"Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Retrieve the authenticated user"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["From the session token, extract:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"user_id"}),"\n",(0,t.jsx)(n.li,{children:"role (e.g., admin, clinician)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Implement policy logic"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"In each operation (GET, PUT, DELETE), apply conditional logic:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"if ($currentUserRole === 'admin') {\n    // No restriction \u2014 full access\n} elseif ($currentUserRole === 'clinician') {\n    // Restrict to only their own appointments\n    $query = \"SELECT * FROM appointments WHERE clinician_id = :id\";\n} else {\n    sendJson(['error' => 'Forbidden'], 403);\n}\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Update queries and checks"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"For GET, filter the results by clinician_id if not admin."}),"\n",(0,t.jsx)(n.li,{children:"For PUT, check if the appointment belongs to the authenticated clinician before allowing the update:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$stmt = $pdo->prepare(\"SELECT clinician_id FROM appointments WHERE id = :id\");\n$stmt->execute(['id' => $appointmentId]);\n$appt = $stmt->fetch();\n\nif ($currentUserRole !== 'admin' && $appt['clinician_id'] !== $currentUserId) {\n    sendJson(['error' => 'Forbidden: You can only update your own appointments'], 403);\n}\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Return appropriate responses"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"403 Forbidden if the user violates a policy."}),"\n",(0,t.jsx)(n.li,{children:"200 OK / 201 Created for valid actions."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"testing-3",children:"Testing:"}),"\n",(0,t.jsx)(n.p,{children:"Use Postman to verify policy behavior:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"User"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Expected Behavior"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Admin"})}),(0,t.jsx)(n.td,{children:"Can get, create, update, delete any appointment."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Clinician"})}),(0,t.jsx)(n.td,{children:"Can only view and update appointments assigned to them."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Unauthorized User"})}),(0,t.jsxs)(n.td,{children:["Gets ",(0,t.jsx)(n.strong,{children:"401 Unauthorized"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Other Roles (if any)"})}),(0,t.jsxs)(n.td,{children:["Gets ",(0,t.jsx)(n.strong,{children:"403 Forbidden"}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"mini-project--simple-rbac-dashboard-final-instructions",children:"Mini Project \u2014 Simple RBAC Dashboard (Final Instructions)"}),"\n",(0,t.jsx)(n.h3,{id:"objective-",children:"Objective :"}),"\n",(0,t.jsx)(n.p,{children:"Build a small web platform (dashboard) that demonstrates authentication, role/permission/group management, and a frontend test-suite for API endpoints. The UI uses AJAX (jQuery) to call demo API endpoints and displays responses in a Swagger-like fashion."}),"\n",(0,t.jsx)(n.h3,{id:"what-you-must-do-concise",children:"What you must do (concise)"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create the dashboard with a side menu and the following pages (5 pages total):"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Page 1 \u2014 API Tester: Seven demo API endpoints. Each endpoint must be callable via AJAX (jQuery). Each endpoint should be able to return three canonical responses:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"200 OK (success message)"}),"\n",(0,t.jsx)(n.li,{children:"401 Unauthorized (not logged in / invalid token)"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"403 Forbidden (authenticated but insufficient permission)"}),"\n",(0,t.jsx)(n.li,{children:"Each endpoint is associated with a required role (e.g., admin, clinician, nurse, etc.). On the page show each endpoint with a short description, a button to call it, and a small area below that displays the JSON response and HTTP status (styled like Swagger responses)."}),"\n",(0,t.jsx)(n.li,{children:"Page 2 \u2014 Roles: A table listing roles (id, name, description)."}),"\n",(0,t.jsx)(n.li,{children:"Page 3 \u2014 Permissions: A table listing permissions (id, name, description)."}),"\n",(0,t.jsx)(n.li,{children:"Page 4 \u2014 Groups: A page where groups are listed and each group can be assigned a set of permissions (group \u2192 permissions). Explain that groups can be assigned to users as a convenience."}),"\n",(0,t.jsx)(n.li,{children:"Page 5 \u2014 Users: A list of users. Clicking a user opens an edit view where you can toggle (switch buttons) that user\u2019s assigned roles, permissions, and groups. Changes are saved via AJAX."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"API behavior (backend): Implement minimal endpoints needed for the dashboard (authentication + endpoints that return the demo responses). For the demo endpoints on Page 1: each endpoint must simulate/return the three statuses (200 / 401 / 403) depending on the request context (e.g., missing token \u2192 401, token present but wrong role \u2192 403, token + role OK \u2192 200). The UI should be able to trigger each scenario naturally (by sending/omitting a token or using tokens for different role accounts)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Frontend requirements:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use jQuery AJAX to call the APIs and show results."}),"\n",(0,t.jsx)(n.li,{children:"For each demo endpoint show: endpoint name, required role, a \u201cCall\u201d button, result JSON area, and HTTP status (200/401/403) with clear styling."}),"\n",(0,t.jsx)(n.li,{children:"The display should be compact and user-friendly (Swagger-like response area under each endpoint)."}),"\n",(0,t.jsx)(n.li,{children:"Use toggles/switches on the Users edit page for assigning roles/permissions/groups."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"UX notes: Keep the UI simple and clear \u2014 no need for fancy styling. The important part is functionality: buttons that call APIs and visible responses, and a straightforward CRUD interface for roles/permissions/groups/users."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"testing-what-to-include-in-your-submission",children:"Testing (what to include in your submission)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Demonstrate the three response scenarios for each of the 7 endpoints (200 / 401 / 403). Capture screenshots showing:"}),"\n",(0,t.jsx)(n.li,{children:"Endpoint called successfully (200)."}),"\n",(0,t.jsx)(n.li,{children:"Endpoint returning 401 (no token)."}),"\n",(0,t.jsx)(n.li,{children:"Endpoint returning 403 (token but insufficient role)."}),"\n",(0,t.jsx)(n.li,{children:"Show screenshots of: Roles page, Permissions page, Groups page (with group \u2192 permission assignment), Users page and a user-edit view with switches for role/permission/group."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"submission-single-pdf-only",children:"Submission (single PDF only)"}),"\n",(0,t.jsxs)(n.p,{children:["Create ",(0,t.jsx)(n.strong,{children:"one"})," PDF file and submit it via the Google Form link below (demo \u2014 replace later):",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://docs.google.com/forms/d/e/1FAIpQLSfy5WQdFYPU28b84C4wR7wW4SyCi_1S6q9KRgrHi1Sj3vLQwA/viewform?usp=header",children:"https://docs.google.com/forms/d/e/1FAIpQLSfy5WQdFYPU28b84C4wR7wW4SyCi_1S6q9KRgrHi1Sj3vLQwA/viewform?usp=header"})})]}),"\n",(0,t.jsx)(n.h3,{id:"demo",children:"Demo"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"mini-project-demo.gif",src:i(978).A+"",width:"2560",height:"1320"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img_8.png",src:i(6066).A+"",width:"2559",height:"1408"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},2712:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_2-2accc5822ed38f5f1c1bacf9baf0fb79.png"},3596:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_6-665becb1bdfcc00d96776f9f8e01bff7.png"},4862:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_4-e59d8f59dbc79530fb0beabc202ddcc2.png"},6066:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_8-d988c521fe5a4437a566743f421e6be4.png"},6661:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_7-33e7e46e3f028b77c72bc9a526d9e6b7.png"},7203:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_1-86eb51fe3b143d762856185dc6718746.png"},7879:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/img_5-d70e6a46159c57830aa80ac2dab90401.png"},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);